<!DOCTYPE html>
<html>
<head>
    <link href='https://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,300' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Inconsolata:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/default.min.css">
    <link rel="stylesheet" href="/static/zenburn.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/dist/index.js"></script>
    <link rel="stylesheet" href="/css/global.css">
</head>
<body>
<div id="template">
    <div class="container">
        <h1>
            <type>tply</type>
        </h1>
        <wait>1s</wait>
        <h2>
            <type>a virtual typewriter.</type>
        </h2>
        <wait>1s</wait>
        <type data-char-interval="25ms" data-comma-interval="100ms">
            <p>
                Have you ever wondered how in those fancy websites, they get text to show up as if there's a monkey
                sitting
                there, typing everything out? I know <i>I</i> have.
            </p>
            <p>
                Well, now you can have the pleasure of adding this sort of thing to <i>your own</i> website, and the
                best part is, it's basically the same as writing normal HTML.
            </p>
            <p>
                <type>So... what can you do with it?</type>
            </p>
        </type>

        <wait>500ms</wait>

        <div class="gallery" data-ignore-tply="true">
            <div class="section">
                <div class="tply-container">
                    <div class="tply-template">
                        <type>Watch <span style="font-weight: bold;text-decoration:underline;">this:</span></type>
                        <wait>500ms</wait>
                        <br>
                        <type style="font-family: 'Lobster', cursive;">Now <span style="color: blue;font-size: 1.5em;">we're</span> <span
                                style="color: purple;font-size:2em;">cooking!</span>
                        </type>
                        <wait>500ms</wait>
                        <br>
                        <br>
                        <br>
                        <type style="color: green; font-size: 3em; background-color: white; margin-top: 50px; padding: 5px 15px 5px 15px; border-radius:5px;">
                            WOW!
                        </type>
                    </div>
                    <div class="tply-animation"></div>
                </div>
                <div class="cover"><span class="description">write text with <span
                        style="font-family: 'Lobster', cursive;">style</span></span></div>
            </div>
            <div class="section">
                <div class="tply-container">
                    <div class="tply-template">
                        <type data-char-interval="10ms" style="font-size:1.3em;">I CAN TYPE <em>SUPER DUPER FAST</em>
                        </type>
                        <wait>500ms</wait>
                        <br>
                        <type>or i can type super</type>
                        <type data-char-interval="500ms"> duper</type>
                        <type data-char-interval="750ms"> slow.</type>
                    </div>
                    <div class="tply-animation"></div>
                </div>
                <div class="cover"><span class="description">custom typing speeds</span></div>
            </div>
            <div class="section">
                <div class="tply-container">
                    <div class="tply-template">
                        <type>I actually haven't told you something (^;</type>
                        <wait>500ms</wait>
                        <br>
                        <type>This whole time, I've been <em>pausing</em> for arbitrary amounts of time! If you you can
                            count to three, try it now, and I'll wait for you.
                        </type>
                        <wait>100ms</wait>
                        <br>
                        <type data-char-interval="10ms" style="font-weight: bold;">GO</type>
                        <wait>3s</wait>
                        <br>
                        <type>... Did you do it? Congrats!</type>
                    </div>
                    <div class="tply-animation">

                    </div>
                </div>
                <div class="cover"><span class="description">pauses galore</span></div>
            </div>
            <div class="section">
                <div class="cover"></div>
            </div>
        </div>
    </div>
</div>
<div id="animation">
</div>

<script>
    "use strict";

    let covers = document.querySelectorAll(".cover");
    let transitionInDuration = 200;
    let transitionOutDuration = 500;

    let isDone = Array.apply(null, new Array(covers.length)).map(function() {
        return true;
    });

    let mouseIn = isDone.map(function () {
        return false;
    });

    for (let i = 0; i < covers.length; i++) {
        let cover = covers[i];

        let section = cover.parentElement;
        let template = section.querySelector(".tply-template");
        let animation = section.querySelector(".tply-animation");

        let reset = function () {
            if (cover.classList.contains("hidden")) {
                setTimeout(function () {
                    cover.classList.remove("hidden");
                    animation.innerHTML = "";
                }, transitionOutDuration);
            }
        };

        cover.addEventListener("click", function (e) {
            isDone[i] = false;

            cover.classList.add("hidden");

            setTimeout(function () {
                tply.animate(template, animation, {}, function () {
                    isDone[i] = true;

                    if (!mouseIn[i]) {
                        setTimeout(reset, 400)
                    }
                });
            }, transitionInDuration);
        });

        section.addEventListener("mouseover", function (e) {
            mouseIn[i] = true;
        });

        section.addEventListener("mouseout", function (e) {
            mouseIn[i] = false;

            e = event.toElement || event.relatedTarget;

            while (e && e.parentNode && e.parentNode != window) {
                if (e.parentNode == this || e == this) {
                    if (e.preventDefault) e.preventDefault();
                    return false;
                }
                e = e.parentNode;
            }

            if (isDone[i]) {
                reset();
            }
        });
    }

    let cancel = tply.animate(document.getElementById("template"), document.getElementById("animation"), {
        types: [
            {
                name: "robot",
                properties: {
                    "data-char-interval": "0ms",
                    "data-period-interval": "0ms",
                    "data-comma-interval": "0ms",
                    "data-end-interval": "0ms",
                    "data-word-interval": "200ms"
                },
                styleClasses: "robot",
                style: "color: red;"
            }
        ],
        processing: [
            {
                tag: "code",
                post: function (element) {
                    hljs.highlightBlock(element);
                }
            }
        ]
    });

    cancel.registerCancellationListener(function() {
        alert("cancelled");
    });
</script>
</body>
</html>