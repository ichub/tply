<!DOCTYPE html>
<head>
    <link href='https://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,300' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Inconsolata:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/default.min.css">
    <link rel="stylesheet" href="/static/zenburn.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
    <script src="/dist/index.js"></script>
    <link rel="stylesheet" href="/css/global.css">
</head>
<body>
<div class="container">
    <h1>tply demo</h1>

    <div class="examples">
        <div class="example-container" data-title="simple text">
            <type>
                Why, hello there! How are you? I'm good!
            </type>
        </div>
        <div class="example-container" data-title="pauses">
            <type>Once upon a time...</type>
            <wait>500ms</wait>
            <br>
            <type>There was a dramatic pause!</type>
        </div>
        <div class="example-container" data-title="repeats">
            <repeat data-repeat="3">
                <type>This will repeat three times!</type>
                <br>
            </repeat>
        </div>
        <div class="example-container" data-title="clears (and infinite repeat)">
            <repeat data-repeat="infinite">
                <type>This will repeat forever!</type>
                <wait>1s</wait>
                <clear_parent></clear_parent>
            </repeat>
        </div>
    </div>

    <script>
        (function () {
            "use strict";

            let unindentCode = function (text) {
                let parts = text.split("\n").filter(function(item) {
                    return item.length > 0;
                });

                let result = "";

                if (parts.length > 0) {
                    let count = 0;
                    while (parts[0][count] == " " && count < parts[0].length) {
                        count++;
                    }

                    for (let i = 0; i < parts.length; i++) {
                        let part = parts[i];
                        let partText = "";

                        for (let j = count; j < parts[i].length; j++) {
                            partText += part[j];
                        }

                        result += partText;

                        if (i < parts.length - 2) {
                            result += "\n";
                        }
                    }
                }

                return result;
            };

            let examples = document.querySelectorAll(".examples .example-container");

            for (let i = 0; i < examples.length; i++) {
                let exampleContainer = examples[i];

                let example = document.createElement("div");
                example.classList.add("example");

                let template = document.createElement("div");
                template.classList.add("tply-template");
                template.innerHTML = exampleContainer.innerHTML;
                exampleContainer.innerHTML = "";

                let title = document.createElement("div");
                title.classList.add("title");
                title.innerText = exampleContainer.getAttribute("data-title");

                exampleContainer.appendChild(title);

                example.appendChild(template);
                exampleContainer.appendChild(example);

                let destination = document.createElement("div");
                destination.classList.add("tply-destination");
                template.parentNode.appendChild(destination);

                let code = document.createElement("code");
                let pre = document.createElement("pre");

                pre.innerText = unindentCode(template.innerHTML);

                code.appendChild(pre);
                exampleContainer.appendChild(code);

                hljs.highlightBlock(code);

                tply.animate(template, destination);
            }
        })();
    </script>
</div>
</body>
</html>